use bitvec::prelude::*;

use crate::{
    bitreader::{BitField, BitReader},
    fec::CodeRate,
};

pub(crate) struct PhyCodedHeader {
    pub rate: CodeRate,
    pub data_length: usize,
}

impl PhyCodedHeader {
    pub const fn new(rate: CodeRate, data_length: usize) -> Self {
        Self { rate, data_length }
    }

    pub fn read<T: BitStore>(reader: &mut BitReader<T, Msb0>) -> Option<(Self, usize)> {
        let first = 0xC0000000 | reader.read_bits::<u32>(30)?;
        let second = reader.read_bits::<u32>(32)?;
        let third = reader.read_bits::<u32>(20)? << 12;

        let (length12, distance12) =
            PhyCodedHeader::find_best_length(&RATE_ONE_HALF, first, second, third);
        if distance12 == 0 {
            return Some((
                PhyCodedHeader {
                    rate: CodeRate::OneHalf,
                    data_length: length12,
                },
                distance12,
            ));
        }

        let (length13, distance13) =
            PhyCodedHeader::find_best_length(&RATE_ONE_THIRD, first, second, third);
        if distance12 < distance13 {
            Some((
                PhyCodedHeader {
                    rate: CodeRate::OneHalf,
                    data_length: length12,
                },
                distance12,
            ))
        } else {
            Some((
                PhyCodedHeader {
                    rate: CodeRate::OneThird,
                    data_length: length13,
                },
                distance13,
            ))
        }
    }

    fn find_best_length(
        table: &[[u32; 3]; 240],
        first: u32,
        second: u32,
        third: u32,
    ) -> (usize, usize) {
        let mut found_length = 0;
        let mut min_distance = usize::MAX;

        for (index, row) in table.iter().enumerate() {
            let distance = ((row[0] ^ first).count_ones()
                + (row[1] ^ second).count_ones()
                + (row[2] ^ third).count_ones()) as usize;

            if distance < min_distance {
                min_distance = distance;
                found_length = index + 12;

                if min_distance == 0 {
                    return (found_length, 0);
                }
            }
        }

        (found_length, min_distance)
    }

    pub fn write<T: BitStore>(&self, writer: &mut BitVec<T, Msb0>) {
        let table = match self.rate {
            CodeRate::OneThird => &RATE_ONE_THIRD,
            CodeRate::OneHalf => &RATE_ONE_HALF,
        };
        let index = self.data_length - 12;
        let entry = table[index].view_bits::<Msb0>();

        writer.extend_from_bitslice(&entry[2..32 + 32 + 20]);
    }
}

#[rustfmt::skip]
#[allow(clippy::unusual_byte_groupings)]
const RATE_ONE_HALF: [[u32; 3]; 240] = [
    [ 0b11_00001100_0000100011000000011100, 0b01110010110111011001011011010000, 0b00001110011011110000_000000000000 ],
    [ 0b11_00001101_0000100100100101011011, 0b11100101110111011001011010010011, 0b00101011111100100000_000000000000 ],
    [ 0b11_00001110_0000101100001011011100, 0b10000000000111010110010000010011, 0b10010000000101100000_000000000000 ],
    [ 0b11_00001111_0000101011101110011011, 0b00010111000111010110010001010000, 0b10110101100010110000_000000000000 ],
    [ 0b11_00010000_0001111000100101000001, 0b11100101100111100101101100010011, 0b00101100100101100000_000000000000 ],
    [ 0b11_00010001_0001111111000000000110, 0b01110010100111100101101101010000, 0b00001001000010110000_000000000000 ],
    [ 0b11_00010010_0001110111101110000001, 0b00010111010111101010100111010000, 0b10110010111011110000_000000000000 ],
    [ 0b11_00010011_0001110000001011000110, 0b10000000010111101010100110010011, 0b10010111011100100000_000000000000 ],
    [ 0b11_00010100_0001100110110010011111, 0b10111001000111100101101011010001, 0b11011011111011110000_000000000000 ],
    [ 0b11_00010101_0001100001010111011000, 0b00101110000111100101101010010010, 0b11111110011100100000_000000000000 ],
    [ 0b11_00010110_0001101001111001011111, 0b01001011110111101010100000010010, 0b01000101100101100000_000000000000 ],
    [ 0b11_00010111_0001101110011100011000, 0b11011100110111101010100001010001, 0b01100000000010110000_000000000000 ],
    [ 0b11_00011000_0001000100001011000010, 0b00101110000111011001000010010011, 0b10011110010111010000_000000000000 ],
    [ 0b11_00011001_0001000011101110000101, 0b10111001000111011001000011010000, 0b10111011110000000000_000000000000 ],
    [ 0b11_00011010_0001001011000000000010, 0b11011100110111010110001001010000, 0b00000000001001000000_000000000000 ],
    [ 0b11_00011011_0001001100100101000101, 0b01001011110111010110001000010011, 0b00100101101110010000_000000000000 ],
    [ 0b11_00011100_0001011010011100011100, 0b01110010100111011001000101010001, 0b01101001001001000000_000000000000 ],
    [ 0b11_00011101_0001011101111001011011, 0b11100101100111011001000100010010, 0b01001100101110010000_000000000000 ],
    [ 0b11_00011110_0001010101010111011100, 0b10000000010111010110001110010010, 0b11110111010111010000_000000000000 ],
    [ 0b11_00011111_0001010010110010011011, 0b00010111010111010110001111010001, 0b11010010110000000000_000000000000 ],
    [ 0b11_00100000_0011110011000000001110, 0b11001011100100010111001011010000, 0b00000010111110010000_000000000000 ],
    [ 0b11_00100001_0011110100100101001001, 0b01011100100100010111001010010011, 0b00100111011001000000_000000000000 ],
    [ 0b11_00100010_0011111100001011001110, 0b00111001010100011000000000010011, 0b10011100100000000000_000000000000 ],
    [ 0b11_00100011_0011111011101110001001, 0b10101110010100011000000001010000, 0b10111001000111010000_000000000000 ],
    [ 0b11_00100100_0011101101010111010000, 0b10010111000100010111001100010010, 0b11110101100000000000_000000000000 ],
    [ 0b11_00100101_0011101010110010010111, 0b00000000000100010111001101010001, 0b11010000000111010000_000000000000 ],
    [ 0b11_00100110_0011100010011100010000, 0b01100101110100011000000111010001, 0b01101011111110010000_000000000000 ],
    [ 0b11_00100111_0011100101111001010111, 0b11110010110100011000000110010010, 0b01001110011001000000_000000000000 ],
    [ 0b11_00101000_0011001111101110001101, 0b00000000000100101011100101010000, 0b10110000001100100000_000000000000 ],
    [ 0b11_00101001_0011001000001011001010, 0b10010111000100101011100100010011, 0b10010101101011110000_000000000000 ],
    [ 0b11_00101010_0011000000100101001101, 0b11110010110100100100101110010011, 0b00101110010010110000_000000000000 ],
    [ 0b11_00101011_0011000111000000001010, 0b01100101110100100100101111010000, 0b00001011110101100000_000000000000 ],
    [ 0b11_00101100_0011010001111001010011, 0b01011100100100101011100010010010, 0b01000111010010110000_000000000000 ],
    [ 0b11_00101101_0011010110011100010100, 0b11001011100100101011100011010001, 0b01100010110101100000_000000000000 ],
    [ 0b11_00101110_0011011110110010010011, 0b10101110010100100100101001010001, 0b11011001001100100000_000000000000 ],
    [ 0b11_00101111_0011011001010111010100, 0b00111001010100100100101000010010, 0b11111100101011110000_000000000000 ],
    [ 0b11_00110000_0010001010011100001110, 0b11001011110100010111010101010001, 0b01100101101100100000_000000000000 ],
    [ 0b11_00110001_0010001101111001001001, 0b01011100110100010111010100010010, 0b01000000001011110000_000000000000 ],
    [ 0b11_00110010_0010000101010111001110, 0b00111001000100011000011110010010, 0b11111011110010110000_000000000000 ],
    [ 0b11_00110011_0010000010110010001001, 0b10101110000100011000011111010001, 0b11011110010101100000_000000000000 ],
    [ 0b11_00110100_0010010100001011010000, 0b10010111010100010111010010010011, 0b10010010110010110000_000000000000 ],
    [ 0b11_00110101_0010010011101110010111, 0b00000000010100010111010011010000, 0b10110111010101100000_000000000000 ],
    [ 0b11_00110110_0010011011000000010000, 0b01100101100100011000011001010000, 0b00001100101100100000_000000000000 ],
    [ 0b11_00110111_0010011100100101010111, 0b11110010100100011000011000010011, 0b00101001001011110000_000000000000 ],
    [ 0b11_00111000_0010110110110010001101, 0b00000000010100101011111011010001, 0b11010111011110010000_000000000000 ],
    [ 0b11_00111001_0010110001010111001010, 0b10010111010100101011111010010010, 0b11110010111001000000_000000000000 ],
    [ 0b11_00111010_0010111001111001001101, 0b11110010100100100100110000010010, 0b01001001000000000000_000000000000 ],
    [ 0b11_00111011_0010111110011100001010, 0b01100101100100100100110001010001, 0b01101100100111010000_000000000000 ],
    [ 0b11_00111100_0010101000100101010011, 0b01011100110100101011111100010011, 0b00100000000000000000_000000000000 ],
    [ 0b11_00111101_0010101111000000010100, 0b11001011110100101011111101010000, 0b00000101100111010000_000000000000 ],
    [ 0b11_00111110_0010100111101110010011, 0b10101110000100100100110111010000, 0b10111110011110010000_000000000000 ],
    [ 0b11_00111111_0010100000001011010100, 0b00111001000100100100110110010011, 0b10011011111001000000_000000000000 ],
    [ 0b11_01000000_0111100100001011000001, 0b11100100000111100100001011010011, 0b10010101101110010000_000000000000 ],
    [ 0b11_01000001_0111100011101110000110, 0b01110011000111100100001010010000, 0b10110000001001000000_000000000000 ],
    [ 0b11_01000010_0111101011000000000001, 0b00010110110111101011000000010000, 0b00001011110000000000_000000000000 ],
    [ 0b11_01000011_0111101100100101000110, 0b10000001110111101011000001010011, 0b00101110010111010000_000000000000 ],
    [ 0b11_01000100_0111111010011100011111, 0b10111000100111100100001100010001, 0b01100010110000000000_000000000000 ],
    [ 0b11_01000101_0111111101111001011000, 0b00101111100111100100001101010010, 0b01000111010111010000_000000000000 ],
    [ 0b11_01000110_0111110101010111011111, 0b01001010010111101011000111010010, 0b11111100101110010000_000000000000 ],
    [ 0b11_01000111_0111110010110010011000, 0b11011101010111101011000110010001, 0b11011001001001000000_000000000000 ],
    [ 0b11_01001000_0111011000100101000010, 0b00101111100111011000100101010011, 0b00100111011100100000_000000000000 ],
    [ 0b11_01001001_0111011111000000000101, 0b10111000100111011000100100010000, 0b00000010111011110000_000000000000 ],
    [ 0b11_01001010_0111010111101110000010, 0b11011101010111010111101110010000, 0b10111001000010110000_000000000000 ],
    [ 0b11_01001011_0111010000001011000101, 0b01001010010111010111101111010011, 0b10011100100101100000_000000000000 ],
    [ 0b11_01001100_0111000110110010011100, 0b01110011000111011000100010010001, 0b11010000000010110000_000000000000 ],
    [ 0b11_01001101_0111000001010111011011, 0b11100100000111011000100011010010, 0b11110101100101100000_000000000000 ],
    [ 0b11_01001110_0111001001111001011100, 0b10000001110111010111101001010010, 0b01001110011100100000_000000000000 ],
    [ 0b11_01001111_0111001110011100011011, 0b00010110110111010111101000010001, 0b01101011111011110000_000000000000 ],
    [ 0b11_01010000_0110011101010111000001, 0b11100100010111100100010101010010, 0b11110010111100100000_000000000000 ],
    [ 0b11_01010001_0110011010110010000110, 0b01110011010111100100010100010001, 0b11010111011011110000_000000000000 ],
    [ 0b11_01010010_0110010010011100000001, 0b00010110100111101011011110010001, 0b01101100100010110000_000000000000 ],
    [ 0b11_01010011_0110010101111001000110, 0b10000001100111101011011111010010, 0b01001001000101100000_000000000000 ],
    [ 0b11_01010100_0110000011000000011111, 0b10111000110111100100010010010000, 0b00000101100010110000_000000000000 ],
    [ 0b11_01010101_0110000100100101011000, 0b00101111110111100100010011010011, 0b00100000000101100000_000000000000 ],
    [ 0b11_01010110_0110001100001011011111, 0b01001010000111101011011001010011, 0b10011011111100100000_000000000000 ],
    [ 0b11_01010111_0110001011101110011000, 0b11011101000111101011011000010000, 0b10111110011011110000_000000000000 ],
    [ 0b11_01011000_0110100001111001000010, 0b00101111110111011000111011010010, 0b01000000001110010000_000000000000 ],
    [ 0b11_01011001_0110100110011100000101, 0b10111000110111011000111010010001, 0b01100101101001000000_000000000000 ],
    [ 0b11_01011010_0110101110110010000010, 0b11011101000111010111110000010001, 0b11011110010000000000_000000000000 ],
    [ 0b11_01011011_0110101001010111000101, 0b01001010000111010111110001010010, 0b11111011110111010000_000000000000 ],
    [ 0b11_01011100_0110111111101110011100, 0b01110011010111011000111100010000, 0b10110111010000000000_000000000000 ],
    [ 0b11_01011101_0110111000001011011011, 0b11100100010111011000111101010011, 0b10010010110111010000_000000000000 ],
    [ 0b11_01011110_0110110000100101011100, 0b10000001100111010111110111010011, 0b00101001001110010000_000000000000 ],
    [ 0b11_01011111_0110110111000000011011, 0b00010110100111010111110110010000, 0b00001100101001000000_000000000000 ],
    [ 0b11_01100000_0100010110110010001110, 0b11001010010100010110110010010001, 0b11011100100111010000_000000000000 ],
    [ 0b11_01100001_0100010001010111001001, 0b01011101010100010110110011010010, 0b11111001000000000000_000000000000 ],
    [ 0b11_01100010_0100011001111001001110, 0b00111000100100011001111001010010, 0b01000010111001000000_000000000000 ],
    [ 0b11_01100011_0100011110011100001001, 0b10101111100100011001111000010001, 0b01100111011110010000_000000000000 ],
    [ 0b11_01100100_0100001000100101010000, 0b10010110110100010110110101010011, 0b00101011111001000000_000000000000 ],
    [ 0b11_01100101_0100001111000000010111, 0b00000001110100010110110100010000, 0b00001110011110010000_000000000000 ],
    [ 0b11_01100110_0100000111101110010000, 0b01100100000100011001111110010000, 0b10110101100111010000_000000000000 ],
    [ 0b11_01100111_0100000000001011010111, 0b11110011000100011001111111010011, 0b10010000000000000000_000000000000 ],
    [ 0b11_01101000_0100101010011100001101, 0b00000001110100101010011100010001, 0b01101110010101100000_000000000000 ],
    [ 0b11_01101001_0100101101111001001010, 0b10010110110100101010011101010010, 0b01001011110010110000_000000000000 ],
    [ 0b11_01101010_0100100101010111001101, 0b11110011000100100101010111010010, 0b11110000001011110000_000000000000 ],
    [ 0b11_01101011_0100100010110010001010, 0b01100100000100100101010110010001, 0b11010101101100100000_000000000000 ],
    [ 0b11_01101100_0100110100001011010011, 0b01011101010100101010011011010011, 0b10011001001011110000_000000000000 ],
    [ 0b11_01101101_0100110011101110010100, 0b11001010010100101010011010010000, 0b10111100101100100000_000000000000 ],
    [ 0b11_01101110_0100111011000000010011, 0b10101111100100100101010000010000, 0b00000111010101100000_000000000000 ],
    [ 0b11_01101111_0100111100100101010100, 0b00111000100100100101010001010011, 0b00100010110010110000_000000000000 ],
    [ 0b11_01110000_0101101111101110001110, 0b11001010000100010110101100010000, 0b10111011110101100000_000000000000 ],
    [ 0b11_01110001_0101101000001011001001, 0b01011101000100010110101101010011, 0b10011110010010110000_000000000000 ],
    [ 0b11_01110010_0101100000100101001110, 0b00111000110100011001100111010011, 0b00100101101011110000_000000000000 ],
    [ 0b11_01110011_0101100111000000001001, 0b10101111110100011001100110010000, 0b00000000001100100000_000000000000 ],
    [ 0b11_01110100_0101110001111001010000, 0b10010110100100010110101011010010, 0b01001100101011110000_000000000000 ],
    [ 0b11_01110101_0101110110011100010111, 0b00000001100100010110101010010001, 0b01101001001100100000_000000000000 ],
    [ 0b11_01110110_0101111110110010010000, 0b01100100010100011001100000010001, 0b11010010110101100000_000000000000 ],
    [ 0b11_01110111_0101111001010111010111, 0b11110011010100011001100001010010, 0b11110111010010110000_000000000000 ],
    [ 0b11_01111000_0101010011000000001101, 0b00000001100100101010000010010000, 0b00001001000111010000_000000000000 ],
    [ 0b11_01111001_0101010100100101001010, 0b10010110100100101010000011010011, 0b00101100100000000000_000000000000 ],
    [ 0b11_01111010_0101011100001011001101, 0b11110011010100100101001001010011, 0b10010111011001000000_000000000000 ],
    [ 0b11_01111011_0101011011101110001010, 0b01100100010100100101001000010000, 0b10110010111110010000_000000000000 ],
    [ 0b11_01111100_0101001101010111010011, 0b01011101000100101010000101010010, 0b11111110011001000000_000000000000 ],
    [ 0b11_01111101_0101001010110010010100, 0b11001010000100101010000100010001, 0b11011011111110010000_000000000000 ],
    [ 0b11_01111110_0101000010011100010011, 0b10101111110100100101001110010001, 0b01100000000111010000_000000000000 ],
    [ 0b11_01111111_0101000101111001010100, 0b00111000110100100101001111010010, 0b01000101100000000000_000000000000 ],
    [ 0b11_10000000_1111001010011100111101, 0b01011100101000101110010111010001, 0b01100111011011110000_000000000000 ],
    [ 0b11_10000001_1111001101111001111010, 0b11001011101000101110010110010010, 0b01000010111100100000_000000000000 ],
    [ 0b11_10000010_1111000101010111111101, 0b10101110011000100001011100010010, 0b11111001000101100000_000000000000 ],
    [ 0b11_10000011_1111000010110010111010, 0b00111001011000100001011101010001, 0b11011100100010110000_000000000000 ],
    [ 0b11_10000100_1111010100001011100011, 0b00000000001000101110010000010011, 0b10010000000101100000_000000000000 ],
    [ 0b11_10000101_1111010011101110100100, 0b10010111001000101110010001010000, 0b10110101100010110000_000000000000 ],
    [ 0b11_10000110_1111011011000000100011, 0b11110010111000100001011011010000, 0b00001110011011110000_000000000000 ],
    [ 0b11_10000111_1111011100100101100100, 0b01100101111000100001011010010011, 0b00101011111100100000_000000000000 ],
    [ 0b11_10001000_1111110110110010111110, 0b10010111001000010010111001010001, 0b11010101101001000000_000000000000 ],
    [ 0b11_10001001_1111110001010111111001, 0b00000000001000010010111000010010, 0b11110000001110010000_000000000000 ],
    [ 0b11_10001010_1111111001111001111110, 0b01100101111000011101110010010010, 0b01001011110111010000_000000000000 ],
    [ 0b11_10001011_1111111110011100111001, 0b11110010111000011101110011010001, 0b01101110010000000000_000000000000 ],
    [ 0b11_10001100_1111101000100101100000, 0b11001011101000010010111110010011, 0b00100010110111010000_000000000000 ],
    [ 0b11_10001101_1111101111000000100111, 0b01011100101000010010111111010000, 0b00000111010000000000_000000000000 ],
    [ 0b11_10001110_1111100111101110100000, 0b00111001011000011101110101010000, 0b10111100101001000000_000000000000 ],
    [ 0b11_10001111_1111100000001011100111, 0b10101110011000011101110100010011, 0b10011001001110010000_000000000000 ],
    [ 0b11_10010000_1110110011000000111101, 0b01011100111000101110001001010000, 0b00000000001001000000_000000000000 ],
    [ 0b11_10010001_1110110100100101111010, 0b11001011111000101110001000010011, 0b00100101101110010000_000000000000 ],
    [ 0b11_10010010_1110111100001011111101, 0b10101110001000100001000010010011, 0b10011110010111010000_000000000000 ],
    [ 0b11_10010011_1110111011101110111010, 0b00111001001000100001000011010000, 0b10111011110000000000_000000000000 ],
    [ 0b11_10010100_1110101101010111100011, 0b00000000011000101110001110010010, 0b11110111010111010000_000000000000 ],
    [ 0b11_10010101_1110101010110010100100, 0b10010111011000101110001111010001, 0b11010010110000000000_000000000000 ],
    [ 0b11_10010110_1110100010011100100011, 0b11110010101000100001000101010001, 0b01101001001001000000_000000000000 ],
    [ 0b11_10010111_1110100101111001100100, 0b01100101101000100001000100010010, 0b01001100101110010000_000000000000 ],
    [ 0b11_10011000_1110001111101110111110, 0b10010111011000010010100111010000, 0b10110010111011110000_000000000000 ],
    [ 0b11_10011001_1110001000001011111001, 0b00000000011000010010100110010011, 0b10010111011100100000_000000000000 ],
    [ 0b11_10011010_1110000000100101111110, 0b01100101101000011101101100010011, 0b00101100100101100000_000000000000 ],
    [ 0b11_10011011_1110000111000000111001, 0b11110010101000011101101101010000, 0b00001001000010110000_000000000000 ],
    [ 0b11_10011100_1110010001111001100000, 0b11001011111000010010100000010010, 0b01000101100101100000_000000000000 ],
    [ 0b11_10011101_1110010110011100100111, 0b01011100111000010010100001010001, 0b01100000000010110000_000000000000 ],
    [ 0b11_10011110_1110011110110010100000, 0b00111001001000011101101011010001, 0b11011011111011110000_000000000000 ],
    [ 0b11_10011111_1110011001010111100111, 0b10101110001000011101101010010010, 0b11111110011100100000_000000000000 ],
    [ 0b11_10100000_1100111000100101110010, 0b01110010111011011100101110010011, 0b00101110010010110000_000000000000 ],
    [ 0b11_10100001_1100111111000000110101, 0b11100101111011011100101111010000, 0b00001011110101100000_000000000000 ],
    [ 0b11_10100010_1100110111101110110010, 0b10000000001011010011100101010000, 0b10110000001100100000_000000000000 ],
    [ 0b11_10100011_1100110000001011110101, 0b00010111001011010011100100010011, 0b10010101101011110000_000000000000 ],
    [ 0b11_10100100_1100100110110010101100, 0b00101110011011011100101001010001, 0b11011001001100100000_000000000000 ],
    [ 0b11_10100101_1100100001010111101011, 0b10111001011011011100101000010010, 0b11111100101011110000_000000000000 ],
    [ 0b11_10100110_1100101001111001101100, 0b11011100101011010011100010010010, 0b01000111010010110000_000000000000 ],
    [ 0b11_10100111_1100101110011100101011, 0b01001011101011010011100011010001, 0b01100010110101100000_000000000000 ],
    [ 0b11_10101000_1100000100001011110001, 0b10111001011011100000000000010011, 0b10011100100000000000_000000000000 ],
    [ 0b11_10101001_1100000011101110110110, 0b00101110011011100000000001010000, 0b10111001000111010000_000000000000 ],
    [ 0b11_10101010_1100001011000000110001, 0b01001011101011101111001011010000, 0b00000010111110010000_000000000000 ],
    [ 0b11_10101011_1100001100100101110110, 0b11011100101011101111001010010011, 0b00100111011001000000_000000000000 ],
    [ 0b11_10101100_1100011010011100101111, 0b11100101111011100000000111010001, 0b01101011111110010000_000000000000 ],
    [ 0b11_10101101_1100011101111001101000, 0b01110010111011100000000110010010, 0b01001110011001000000_000000000000 ],
    [ 0b11_10101110_1100010101010111101111, 0b00010111001011101111001100010010, 0b11110101100000000000_000000000000 ],
    [ 0b11_10101111_1100010010110010101000, 0b10000000001011101111001101010001, 0b11010000000111010000_000000000000 ],
    [ 0b11_10110000_1101000001111001110010, 0b01110010101011011100110000010010, 0b01001001000000000000_000000000000 ],
    [ 0b11_10110001_1101000110011100110101, 0b11100101101011011100110001010001, 0b01101100100111010000_000000000000 ],
    [ 0b11_10110010_1101001110110010110010, 0b10000000011011010011111011010001, 0b11010111011110010000_000000000000 ],
    [ 0b11_10110011_1101001001010111110101, 0b00010111011011010011111010010010, 0b11110010111001000000_000000000000 ],
    [ 0b11_10110100_1101011111101110101100, 0b00101110001011011100110111010000, 0b10111110011110010000_000000000000 ],
    [ 0b11_10110101_1101011000001011101011, 0b10111001001011011100110110010011, 0b10011011111001000000_000000000000 ],
    [ 0b11_10110110_1101010000100101101100, 0b11011100111011010011111100010011, 0b00100000000000000000_000000000000 ],
    [ 0b11_10110111_1101010111000000101011, 0b01001011111011010011111101010000, 0b00000101100111010000_000000000000 ],
    [ 0b11_10111000_1101111101010111110001, 0b10111001001011100000011110010010, 0b11111011110010110000_000000000000 ],
    [ 0b11_10111001_1101111010110010110110, 0b00101110001011100000011111010001, 0b11011110010101100000_000000000000 ],
    [ 0b11_10111010_1101110010011100110001, 0b01001011111011101111010101010001, 0b01100101101100100000_000000000000 ],
    [ 0b11_10111011_1101110101111001110110, 0b11011100111011101111010100010010, 0b01000000001011110000_000000000000 ],
    [ 0b11_10111100_1101100011000000101111, 0b11100101101011100000011001010000, 0b00001100101100100000_000000000000 ],
    [ 0b11_10111101_1101100100100101101000, 0b01110010101011100000011000010011, 0b00101001001011110000_000000000000 ],
    [ 0b11_10111110_1101101100001011101111, 0b00010111011011101111010010010011, 0b10010010110010110000_000000000000 ],
    [ 0b11_10111111_1101101011101110101000, 0b10000000011011101111010011010000, 0b10110111010101100000_000000000000 ],
    [ 0b11_11000000_1000101111101110111101, 0b01011101011000101111101110010000, 0b10111001000010110000_000000000000 ],
    [ 0b11_11000001_1000101000001011111010, 0b11001010011000101111101111010011, 0b10011100100101100000_000000000000 ],
    [ 0b11_11000010_1000100000100101111101, 0b10101111101000100000100101010011, 0b00100111011100100000_000000000000 ],
    [ 0b11_11000011_1000100111000000111010, 0b00111000101000100000100100010000, 0b00000010111011110000_000000000000 ],
    [ 0b11_11000100_1000110001111001100011, 0b00000001111000101111101001010010, 0b01001110011100100000_000000000000 ],
    [ 0b11_11000101_1000110110011100100100, 0b10010110111000101111101000010001, 0b01101011111011110000_000000000000 ],
    [ 0b11_11000110_1000111110110010100011, 0b11110011001000100000100010010001, 0b11010000000010110000_000000000000 ],
    [ 0b11_11000111_1000111001010111100100, 0b01100100001000100000100011010010, 0b11110101100101100000_000000000000 ],
    [ 0b11_11001000_1000010011000000111110, 0b10010110111000010011000000010000, 0b00001011110000000000_000000000000 ],
    [ 0b11_11001001_1000010100100101111001, 0b00000001111000010011000001010011, 0b00101110010111010000_000000000000 ],
    [ 0b11_11001010_1000011100001011111110, 0b01100100001000011100001011010011, 0b10010101101110010000_000000000000 ],
    [ 0b11_11001011_1000011011101110111001, 0b11110011001000011100001010010000, 0b10110000001001000000_000000000000 ],
    [ 0b11_11001100_1000001101010111100000, 0b11001010011000010011000111010010, 0b11111100101110010000_000000000000 ],
    [ 0b11_11001101_1000001010110010100111, 0b01011101011000010011000110010001, 0b11011001001001000000_000000000000 ],
    [ 0b11_11001110_1000000010011100100000, 0b00111000101000011100001100010001, 0b01100010110000000000_000000000000 ],
    [ 0b11_11001111_1000000101111001100111, 0b10101111101000011100001101010010, 0b01000111010111010000_000000000000 ],
    [ 0b11_11010000_1001010110110010111101, 0b01011101001000101111110000010001, 0b11011110010000000000_000000000000 ],
    [ 0b11_11010001_1001010001010111111010, 0b11001010001000101111110001010010, 0b11111011110111010000_000000000000 ],
    [ 0b11_11010010_1001011001111001111101, 0b10101111111000100000111011010010, 0b01000000001110010000_000000000000 ],
    [ 0b11_11010011_1001011110011100111010, 0b00111000111000100000111010010001, 0b01100101101001000000_000000000000 ],
    [ 0b11_11010100_1001001000100101100011, 0b00000001101000101111110111010011, 0b00101001001110010000_000000000000 ],
    [ 0b11_11010101_1001001111000000100100, 0b10010110101000101111110110010000, 0b00001100101001000000_000000000000 ],
    [ 0b11_11010110_1001000111101110100011, 0b11110011011000100000111100010000, 0b10110111010000000000_000000000000 ],
    [ 0b11_11010111_1001000000001011100100, 0b01100100011000100000111101010011, 0b10010010110111010000_000000000000 ],
    [ 0b11_11011000_1001101010011100111110, 0b10010110101000010011011110010001, 0b01101100100010110000_000000000000 ],
    [ 0b11_11011001_1001101101111001111001, 0b00000001101000010011011111010010, 0b01001001000101100000_000000000000 ],
    [ 0b11_11011010_1001100101010111111110, 0b01100100011000011100010101010010, 0b11110010111100100000_000000000000 ],
    [ 0b11_11011011_1001100010110010111001, 0b11110011011000011100010100010001, 0b11010111011011110000_000000000000 ],
    [ 0b11_11011100_1001110100001011100000, 0b11001010001000010011011001010011, 0b10011011111100100000_000000000000 ],
    [ 0b11_11011101_1001110011101110100111, 0b01011101001000010011011000010000, 0b10111110011011110000_000000000000 ],
    [ 0b11_11011110_1001111011000000100000, 0b00111000111000011100010010010000, 0b00000101100010110000_000000000000 ],
    [ 0b11_11011111_1001111100100101100111, 0b10101111111000011100010011010011, 0b00100000000101100000_000000000000 ],
    [ 0b11_11100000_1011011101010111110010, 0b01110011001011011101010111010010, 0b11110000001011110000_000000000000 ],
    [ 0b11_11100001_1011011010110010110101, 0b11100100001011011101010110010001, 0b11010101101100100000_000000000000 ],
    [ 0b11_11100010_1011010010011100110010, 0b10000001111011010010011100010001, 0b01101110010101100000_000000000000 ],
    [ 0b11_11100011_1011010101111001110101, 0b00010110111011010010011101010010, 0b01001011110010110000_000000000000 ],
    [ 0b11_11100100_1011000011000000101100, 0b00101111101011011101010000010000, 0b00000111010101100000_000000000000 ],
    [ 0b11_11100101_1011000100100101101011, 0b10111000101011011101010001010011, 0b00100010110010110000_000000000000 ],
    [ 0b11_11100110_1011001100001011101100, 0b11011101011011010010011011010011, 0b10011001001011110000_000000000000 ],
    [ 0b11_11100111_1011001011101110101011, 0b01001010011011010010011010010000, 0b10111100101100100000_000000000000 ],
    [ 0b11_11101000_1011100001111001110001, 0b10111000101011100001111001010010, 0b01000010111001000000_000000000000 ],
    [ 0b11_11101001_1011100110011100110110, 0b00101111101011100001111000010001, 0b01100111011110010000_000000000000 ],
    [ 0b11_11101010_1011101110110010110001, 0b01001010011011101110110010010001, 0b11011100100111010000_000000000000 ],
    [ 0b11_11101011_1011101001010111110110, 0b11011101011011101110110011010010, 0b11111001000000000000_000000000000 ],
    [ 0b11_11101100_1011111111101110101111, 0b11100100001011100001111110010000, 0b10110101100111010000_000000000000 ],
    [ 0b11_11101101_1011111000001011101000, 0b01110011001011100001111111010011, 0b10010000000000000000_000000000000 ],
    [ 0b11_11101110_1011110000100101101111, 0b00010110111011101110110101010011, 0b00101011111001000000_000000000000 ],
    [ 0b11_11101111_1011110111000000101000, 0b10000001111011101110110100010000, 0b00001110011110010000_000000000000 ],
    [ 0b11_11110000_1010100100001011110010, 0b01110011011011011101001001010011, 0b10010111011001000000_000000000000 ],
    [ 0b11_11110001_1010100011101110110101, 0b11100100011011011101001000010000, 0b10110010111110010000_000000000000 ],
    [ 0b11_11110010_1010101011000000110010, 0b10000001101011010010000010010000, 0b00001001000111010000_000000000000 ],
    [ 0b11_11110011_1010101100100101110101, 0b00010110101011010010000011010011, 0b00101100100000000000_000000000000 ],
    [ 0b11_11110100_1010111010011100101100, 0b00101111111011011101001110010001, 0b01100000000111010000_000000000000 ],
    [ 0b11_11110101_1010111101111001101011, 0b10111000111011011101001111010010, 0b01000101100000000000_000000000000 ],
    [ 0b11_11110110_1010110101010111101100, 0b11011101001011010010000101010010, 0b11111110011001000000_000000000000 ],
    [ 0b11_11110111_1010110010110010101011, 0b01001010001011010010000100010001, 0b11011011111110010000_000000000000 ],
    [ 0b11_11111000_1010011000100101110001, 0b10111000111011100001100111010011, 0b00100101101011110000_000000000000 ],
    [ 0b11_11111001_1010011111000000110110, 0b00101111111011100001100110010000, 0b00000000001100100000_000000000000 ],
    [ 0b11_11111010_1010010111101110110001, 0b01001010001011101110101100010000, 0b10111011110101100000_000000000000 ],
    [ 0b11_11111011_1010010000001011110110, 0b11011101001011101110101101010011, 0b10011110010010110000_000000000000 ],
];

#[rustfmt::skip]
#[allow(clippy::unusual_byte_groupings)]
const RATE_ONE_THIRD: [[u32; 3]; 240] = [
    [ 0b11_00001100_0000100011000001011100, 0b01110101010111011110111110010001, 0b11011100100111010001_000000000000 ],
    [ 0b11_00001101_0000100100100100011011, 0b11100010010111011110111111010010, 0b11111001000000000001_000000000000 ],
    [ 0b11_00001110_0000101100001010011100, 0b10000111100111010001110101010010, 0b01000010111001000001_000000000000 ],
    [ 0b11_00001111_0000101011101111011011, 0b00010000100111010001110100010001, 0b01100111011110010001_000000000000 ],
    [ 0b11_00010000_0001111000100100000001, 0b11100010000111100010001001010010, 0b11111110011001000001_000000000000 ],
    [ 0b11_00010001_0001111111000001000110, 0b01110101000111100010001000010001, 0b11011011111110010001_000000000000 ],
    [ 0b11_00010010_0001110111101111000001, 0b00010000110111101101000010010001, 0b01100000000111010001_000000000000 ],
    [ 0b11_00010011_0001110000001010000110, 0b10000111110111101101000011010010, 0b01000101100000000001_000000000000 ],
    [ 0b11_00010100_0001100110110011011111, 0b10111110100111100010001110010000, 0b00001001000111010001_000000000000 ],
    [ 0b11_00010101_0001100001010110011000, 0b00101001100111100010001111010011, 0b00101100100000000001_000000000000 ],
    [ 0b11_00010110_0001101001111000011111, 0b01001100010111101101000101010011, 0b10010111011001000001_000000000000 ],
    [ 0b11_00010111_0001101110011101011000, 0b11011011010111101101000100010000, 0b10110010111110010001_000000000000 ],
    [ 0b11_00011000_0001000100001010000010, 0b00101001100111011110100111010010, 0b01001100101011110001_000000000000 ],
    [ 0b11_00011001_0001000011101111000101, 0b10111110100111011110100110010001, 0b01101001001100100001_000000000000 ],
    [ 0b11_00011010_0001001011000001000010, 0b11011011010111010001101100010001, 0b11010010110101100001_000000000000 ],
    [ 0b11_00011011_0001001100100100000101, 0b01001100010111010001101101010010, 0b11110111010010110001_000000000000 ],
    [ 0b11_00011100_0001011010011101011100, 0b01110101000111011110100000010000, 0b10111011110101100001_000000000000 ],
    [ 0b11_00011101_0001011101111000011011, 0b11100010000111011110100001010011, 0b10011110010010110001_000000000000 ],
    [ 0b11_00011110_0001010101010110011100, 0b10000111110111010001101011010011, 0b00100101101011110001_000000000000 ],
    [ 0b11_00011111_0001010010110011011011, 0b00010000110111010001101010010000, 0b00000000001100100001_000000000000 ],
    [ 0b11_00100000_0011110011000001001110, 0b11001100000100010000101110010001, 0b11010000000010110001_000000000000 ],
    [ 0b11_00100001_0011110100100100001001, 0b01011011000100010000101111010010, 0b11110101100101100001_000000000000 ],
    [ 0b11_00100010_0011111100001010001110, 0b00111110110100011111100101010010, 0b01001110011100100001_000000000000 ],
    [ 0b11_00100011_0011111011101111001001, 0b10101001110100011111100100010001, 0b01101011111011110001_000000000000 ],
    [ 0b11_00100100_0011101101010110010000, 0b10010000100100010000101001010011, 0b00100111011100100001_000000000000 ],
    [ 0b11_00100101_0011101010110011010111, 0b00000111100100010000101000010000, 0b00000010111011110001_000000000000 ],
    [ 0b11_00100110_0011100010011101010000, 0b01100010010100011111100010010000, 0b10111001000010110001_000000000000 ],
    [ 0b11_00100111_0011100101111000010111, 0b11110101010100011111100011010011, 0b10011100100101100001_000000000000 ],
    [ 0b11_00101000_0011001111101111001101, 0b00000111100100101100000000010001, 0b01100010110000000001_000000000000 ],
    [ 0b11_00101001_0011001000001010001010, 0b10010000100100101100000001010010, 0b01000111010111010001_000000000000 ],
    [ 0b11_00101010_0011000000100100001101, 0b11110101010100100011001011010010, 0b11111100101110010001_000000000000 ],
    [ 0b11_00101011_0011000111000001001010, 0b01100010010100100011001010010001, 0b11011001001001000001_000000000000 ],
    [ 0b11_00101100_0011010001111000010011, 0b01011011000100101100000111010011, 0b10010101101110010001_000000000000 ],
    [ 0b11_00101101_0011010110011101010100, 0b11001100000100101100000110010000, 0b10110000001001000001_000000000000 ],
    [ 0b11_00101110_0011011110110011010011, 0b10101001110100100011001100010000, 0b00001011110000000001_000000000000 ],
    [ 0b11_00101111_0011011001010110010100, 0b00111110110100100011001101010011, 0b00101110010111010001_000000000000 ],
    [ 0b11_00110000_0010001010011101001110, 0b11001100010100010000110000010000, 0b10110111010000000001_000000000000 ],
    [ 0b11_00110001_0010001101111000001001, 0b01011011010100010000110001010011, 0b10010010110111010001_000000000000 ],
    [ 0b11_00110010_0010000101010110001110, 0b00111110100100011111111011010011, 0b00101001001110010001_000000000000 ],
    [ 0b11_00110011_0010000010110011001001, 0b10101001100100011111111010010000, 0b00001100101001000001_000000000000 ],
    [ 0b11_00110100_0010010100001010010000, 0b10010000110100010000110111010010, 0b01000000001110010001_000000000000 ],
    [ 0b11_00110101_0010010011101111010111, 0b00000111110100010000110110010001, 0b01100101101001000001_000000000000 ],
    [ 0b11_00110110_0010011011000001010000, 0b01100010000100011111111100010001, 0b11011110010000000001_000000000000 ],
    [ 0b11_00110111_0010011100100100010111, 0b11110101000100011111111101010010, 0b11111011110111010001_000000000000 ],
    [ 0b11_00111000_0010110110110011001101, 0b00000111110100101100011110010000, 0b00000101100010110001_000000000000 ],
    [ 0b11_00111001_0010110001010110001010, 0b10010000110100101100011111010011, 0b00100000000101100001_000000000000 ],
    [ 0b11_00111010_0010111001111000001101, 0b11110101000100100011010101010011, 0b10011011111100100001_000000000000 ],
    [ 0b11_00111011_0010111110011101001010, 0b01100010000100100011010100010000, 0b10111110011011110001_000000000000 ],
    [ 0b11_00111100_0010101000100100010011, 0b01011011010100101100011001010010, 0b11110010111100100001_000000000000 ],
    [ 0b11_00111101_0010101111000001010100, 0b11001100010100101100011000010001, 0b11010111011011110001_000000000000 ],
    [ 0b11_00111110_0010100111101111010011, 0b10101001100100100011010010010001, 0b01101100100010110001_000000000000 ],
    [ 0b11_00111111_0010100000001010010100, 0b00111110100100100011010011010010, 0b01001001000101100001_000000000000 ],
    [ 0b11_01000000_0111100100001010000001, 0b11100011100111100011101110010010, 0b01000111010010110001_000000000000 ],
    [ 0b11_01000001_0111100011101111000110, 0b01110100100111100011101111010001, 0b01100010110101100001_000000000000 ],
    [ 0b11_01000010_0111101011000001000001, 0b00010001010111101100100101010001, 0b11011001001100100001_000000000000 ],
    [ 0b11_01000011_0111101100100100000110, 0b10000110010111101100100100010010, 0b11111100101011110001_000000000000 ],
    [ 0b11_01000100_0111111010011101011111, 0b10111111000111100011101001010000, 0b10110000001100100001_000000000000 ],
    [ 0b11_01000101_0111111101111000011000, 0b00101000000111100011101000010011, 0b10010101101011110001_000000000000 ],
    [ 0b11_01000110_0111110101010110011111, 0b01001101110111101100100010010011, 0b00101110010010110001_000000000000 ],
    [ 0b11_01000111_0111110010110011011000, 0b11011010110111101100100011010000, 0b00001011110101100001_000000000000 ],
    [ 0b11_01001000_0111011000100100000010, 0b00101000000111011111000000010010, 0b11110101100000000001_000000000000 ],
    [ 0b11_01001001_0111011111000001000101, 0b10111111000111011111000001010001, 0b11010000000111010001_000000000000 ],
    [ 0b11_01001010_0111010111101111000010, 0b11011010110111010000001011010001, 0b01101011111110010001_000000000000 ],
    [ 0b11_01001011_0111010000001010000101, 0b01001101110111010000001010010010, 0b01001110011001000001_000000000000 ],
    [ 0b11_01001100_0111000110110011011100, 0b01110100100111011111000111010000, 0b00000010111110010001_000000000000 ],
    [ 0b11_01001101_0111000001010110011011, 0b11100011100111011111000110010011, 0b00100111011001000001_000000000000 ],
    [ 0b11_01001110_0111001001111000011100, 0b10000110010111010000001100010011, 0b10011100100000000001_000000000000 ],
    [ 0b11_01001111_0111001110011101011011, 0b00010001010111010000001101010000, 0b10111001000111010001_000000000000 ],
    [ 0b11_01010000_0110011101010110000001, 0b11100011110111100011110000010011, 0b00100000000000000001_000000000000 ],
    [ 0b11_01010001_0110011010110011000110, 0b01110100110111100011110001010000, 0b00000101100111010001_000000000000 ],
    [ 0b11_01010010_0110010010011101000001, 0b00010001000111101100111011010000, 0b10111110011110010001_000000000000 ],
    [ 0b11_01010011_0110010101111000000110, 0b10000110000111101100111010010011, 0b10011011111001000001_000000000000 ],
    [ 0b11_01010100_0110000011000001011111, 0b10111111010111100011110111010001, 0b11010111011110010001_000000000000 ],
    [ 0b11_01010101_0110000100100100011000, 0b00101000010111100011110110010010, 0b11110010111001000001_000000000000 ],
    [ 0b11_01010110_0110001100001010011111, 0b01001101100111101100111100010010, 0b01001001000000000001_000000000000 ],
    [ 0b11_01010111_0110001011101111011000, 0b11011010100111101100111101010001, 0b01101100100111010001_000000000000 ],
    [ 0b11_01011000_0110100001111000000010, 0b00101000010111011111011110010011, 0b10010010110010110001_000000000000 ],
    [ 0b11_01011001_0110100110011101000101, 0b10111111010111011111011111010000, 0b10110111010101100001_000000000000 ],
    [ 0b11_01011010_0110101110110011000010, 0b11011010100111010000010101010000, 0b00001100101100100001_000000000000 ],
    [ 0b11_01011011_0110101001010110000101, 0b01001101100111010000010100010011, 0b00101001001011110001_000000000000 ],
    [ 0b11_01011100_0110111111101111011100, 0b01110100110111011111011001010001, 0b01100101101100100001_000000000000 ],
    [ 0b11_01011101_0110111000001010011011, 0b11100011110111011111011000010010, 0b01000000001011110001_000000000000 ],
    [ 0b11_01011110_0110110000100100011100, 0b10000110000111010000010010010010, 0b11111011110010110001_000000000000 ],
    [ 0b11_01011111_0110110111000001011011, 0b00010001000111010000010011010001, 0b11011110010101100001_000000000000 ],
    [ 0b11_01100000_0100010110110011001110, 0b11001101110100010001010111010000, 0b00001110011011110001_000000000000 ],
    [ 0b11_01100001_0100010001010110001001, 0b01011010110100010001010110010011, 0b00101011111100100001_000000000000 ],
    [ 0b11_01100010_0100011001111000001110, 0b00111111000100011110011100010011, 0b10010000000101100001_000000000000 ],
    [ 0b11_01100011_0100011110011101001001, 0b10101000000100011110011101010000, 0b10110101100010110001_000000000000 ],
    [ 0b11_01100100_0100001000100100010000, 0b10010001010100010001010000010010, 0b11111001000101100001_000000000000 ],
    [ 0b11_01100101_0100001111000001010111, 0b00000110010100010001010001010001, 0b11011100100010110001_000000000000 ],
    [ 0b11_01100110_0100000111101111010000, 0b01100011100100011110011011010001, 0b01100111011011110001_000000000000 ],
    [ 0b11_01100111_0100000000001010010111, 0b11110100100100011110011010010010, 0b01000010111100100001_000000000000 ],
    [ 0b11_01101000_0100101010011101001101, 0b00000110010100101101111001010000, 0b10111100101001000001_000000000000 ],
    [ 0b11_01101001_0100101101111000001010, 0b10010001010100101101111000010011, 0b10011001001110010001_000000000000 ],
    [ 0b11_01101010_0100100101010110001101, 0b11110100100100100010110010010011, 0b00100010110111010001_000000000000 ],
    [ 0b11_01101011_0100100010110011001010, 0b01100011100100100010110011010000, 0b00000111010000000001_000000000000 ],
    [ 0b11_01101100_0100110100001010010011, 0b01011010110100101101111110010010, 0b01001011110111010001_000000000000 ],
    [ 0b11_01101101_0100110011101111010100, 0b11001101110100101101111111010001, 0b01101110010000000001_000000000000 ],
    [ 0b11_01101110_0100111011000001010011, 0b10101000000100100010110101010001, 0b11010101101001000001_000000000000 ],
    [ 0b11_01101111_0100111100100100010100, 0b00111111000100100010110100010010, 0b11110000001110010001_000000000000 ],
    [ 0b11_01110000_0101101111101111001110, 0b11001101100100010001001001010001, 0b01101001001001000001_000000000000 ],
    [ 0b11_01110001_0101101000001010001001, 0b01011010100100010001001000010010, 0b01001100101110010001_000000000000 ],
    [ 0b11_01110010_0101100000100100001110, 0b00111111010100011110000010010010, 0b11110111010111010001_000000000000 ],
    [ 0b11_01110011_0101100111000001001001, 0b10101000010100011110000011010001, 0b11010010110000000001_000000000000 ],
    [ 0b11_01110100_0101110001111000010000, 0b10010001000100010001001110010011, 0b10011110010111010001_000000000000 ],
    [ 0b11_01110101_0101110110011101010111, 0b00000110000100010001001111010000, 0b10111011110000000001_000000000000 ],
    [ 0b11_01110110_0101111110110011010000, 0b01100011110100011110000101010000, 0b00000000001001000001_000000000000 ],
    [ 0b11_01110111_0101111001010110010111, 0b11110100110100011110000100010011, 0b00100101101110010001_000000000000 ],
    [ 0b11_01111000_0101010011000001001101, 0b00000110000100101101100111010001, 0b11011011111011110001_000000000000 ],
    [ 0b11_01111001_0101010100100100001010, 0b10010001000100101101100110010010, 0b11111110011100100001_000000000000 ],
    [ 0b11_01111010_0101011100001010001101, 0b11110100110100100010101100010010, 0b01000101100101100001_000000000000 ],
    [ 0b11_01111011_0101011011101111001010, 0b01100011110100100010101101010001, 0b01100000000010110001_000000000000 ],
    [ 0b11_01111100_0101001101010110010011, 0b01011010100100101101100000010011, 0b00101100100101100001_000000000000 ],
    [ 0b11_01111101_0101001010110011010100, 0b11001101100100101101100001010000, 0b00001001000010110001_000000000000 ],
    [ 0b11_01111110_0101000010011101010011, 0b10101000010100100010101011010000, 0b10110010111011110001_000000000000 ],
    [ 0b11_01111111_0101000101111000010100, 0b00111111010100100010101010010011, 0b10010111011100100001_000000000000 ],
    [ 0b11_10000000_1111001010011101111101, 0b01011011001000101001110010010000, 0b10110101100111010001_000000000000 ],
    [ 0b11_10000001_1111001101111000111010, 0b11001100001000101001110011010011, 0b10010000000000000001_000000000000 ],
    [ 0b11_10000010_1111000101010110111101, 0b10101001111000100110111001010011, 0b00101011111001000001_000000000000 ],
    [ 0b11_10000011_1111000010110011111010, 0b00111110111000100110111000010000, 0b00001110011110010001_000000000000 ],
    [ 0b11_10000100_1111010100001010100011, 0b00000111101000101001110101010010, 0b01000010111001000001_000000000000 ],
    [ 0b11_10000101_1111010011101111100100, 0b10010000101000101001110100010001, 0b01100111011110010001_000000000000 ],
    [ 0b11_10000110_1111011011000001100011, 0b11110101011000100110111110010001, 0b11011100100111010001_000000000000 ],
    [ 0b11_10000111_1111011100100100100100, 0b01100010011000100110111111010010, 0b11111001000000000001_000000000000 ],
    [ 0b11_10001000_1111110110110011111110, 0b10010000101000010101011100010000, 0b00000111010101100001_000000000000 ],
    [ 0b11_10001001_1111110001010110111001, 0b00000111101000010101011101010011, 0b00100010110010110001_000000000000 ],
    [ 0b11_10001010_1111111001111000111110, 0b01100010011000011010010111010011, 0b10011001001011110001_000000000000 ],
    [ 0b11_10001011_1111111110011101111001, 0b11110101011000011010010110010000, 0b10111100101100100001_000000000000 ],
    [ 0b11_10001100_1111101000100100100000, 0b11001100001000010101011011010010, 0b11110000001011110001_000000000000 ],
    [ 0b11_10001101_1111101111000001100111, 0b01011011001000010101011010010001, 0b11010101101100100001_000000000000 ],
    [ 0b11_10001110_1111100111101111100000, 0b00111110111000011010010000010001, 0b01101110010101100001_000000000000 ],
    [ 0b11_10001111_1111100000001010100111, 0b10101001111000011010010001010010, 0b01001011110010110001_000000000000 ],
    [ 0b11_10010000_1110110011000001111101, 0b01011011011000101001101100010001, 0b11010010110101100001_000000000000 ],
    [ 0b11_10010001_1110110100100100111010, 0b11001100011000101001101101010010, 0b11110111010010110001_000000000000 ],
    [ 0b11_10010010_1110111100001010111101, 0b10101001101000100110100111010010, 0b01001100101011110001_000000000000 ],
    [ 0b11_10010011_1110111011101111111010, 0b00111110101000100110100110010001, 0b01101001001100100001_000000000000 ],
    [ 0b11_10010100_1110101101010110100011, 0b00000111111000101001101011010011, 0b00100101101011110001_000000000000 ],
    [ 0b11_10010101_1110101010110011100100, 0b10010000111000101001101010010000, 0b00000000001100100001_000000000000 ],
    [ 0b11_10010110_1110100010011101100011, 0b11110101001000100110100000010000, 0b10111011110101100001_000000000000 ],
    [ 0b11_10010111_1110100101111000100100, 0b01100010001000100110100001010011, 0b10011110010010110001_000000000000 ],
    [ 0b11_10011000_1110001111101111111110, 0b10010000111000010101000010010001, 0b01100000000111010001_000000000000 ],
    [ 0b11_10011001_1110001000001010111001, 0b00000111111000010101000011010010, 0b01000101100000000001_000000000000 ],
    [ 0b11_10011010_1110000000100100111110, 0b01100010001000011010001001010010, 0b11111110011001000001_000000000000 ],
    [ 0b11_10011011_1110000111000001111001, 0b11110101001000011010001000010001, 0b11011011111110010001_000000000000 ],
    [ 0b11_10011100_1110010001111000100000, 0b11001100011000010101000101010011, 0b10010111011001000001_000000000000 ],
    [ 0b11_10011101_1110010110011101100111, 0b01011011011000010101000100010000, 0b10110010111110010001_000000000000 ],
    [ 0b11_10011110_1110011110110011100000, 0b00111110101000011010001110010000, 0b00001001000111010001_000000000000 ],
    [ 0b11_10011111_1110011001010110100111, 0b10101001101000011010001111010011, 0b00101100100000000001_000000000000 ],
    [ 0b11_10100000_1100111000100100110010, 0b01110101011011011011001011010010, 0b11111100101110010001_000000000000 ],
    [ 0b11_10100001_1100111111000001110101, 0b11100010011011011011001010010001, 0b11011001001001000001_000000000000 ],
    [ 0b11_10100010_1100110111101111110010, 0b10000111101011010100000000010001, 0b01100010110000000001_000000000000 ],
    [ 0b11_10100011_1100110000001010110101, 0b00010000101011010100000001010010, 0b01000111010111010001_000000000000 ],
    [ 0b11_10100100_1100100110110011101100, 0b00101001111011011011001100010000, 0b00001011110000000001_000000000000 ],
    [ 0b11_10100101_1100100001010110101011, 0b10111110111011011011001101010011, 0b00101110010111010001_000000000000 ],
    [ 0b11_10100110_1100101001111000101100, 0b11011011001011010100000111010011, 0b10010101101110010001_000000000000 ],
    [ 0b11_10100111_1100101110011101101011, 0b01001100001011010100000110010000, 0b10110000001001000001_000000000000 ],
    [ 0b11_10101000_1100000100001010110001, 0b10111110111011100111100101010010, 0b01001110011100100001_000000000000 ],
    [ 0b11_10101001_1100000011101111110110, 0b00101001111011100111100100010001, 0b01101011111011110001_000000000000 ],
    [ 0b11_10101010_1100001011000001110001, 0b01001100001011101000101110010001, 0b11010000000010110001_000000000000 ],
    [ 0b11_10101011_1100001100100100110110, 0b11011011001011101000101111010010, 0b11110101100101100001_000000000000 ],
    [ 0b11_10101100_1100011010011101101111, 0b11100010011011100111100010010000, 0b10111001000010110001_000000000000 ],
    [ 0b11_10101101_1100011101111000101000, 0b01110101011011100111100011010011, 0b10011100100101100001_000000000000 ],
    [ 0b11_10101110_1100010101010110101111, 0b00010000101011101000101001010011, 0b00100111011100100001_000000000000 ],
    [ 0b11_10101111_1100010010110011101000, 0b10000111101011101000101000010000, 0b00000010111011110001_000000000000 ],
    [ 0b11_10110000_1101000001111000110010, 0b01110101001011011011010101010011, 0b10011011111100100001_000000000000 ],
    [ 0b11_10110001_1101000110011101110101, 0b11100010001011011011010100010000, 0b10111110011011110001_000000000000 ],
    [ 0b11_10110010_1101001110110011110010, 0b10000111111011010100011110010000, 0b00000101100010110001_000000000000 ],
    [ 0b11_10110011_1101001001010110110101, 0b00010000111011010100011111010011, 0b00100000000101100001_000000000000 ],
    [ 0b11_10110100_1101011111101111101100, 0b00101001101011011011010010010001, 0b01101100100010110001_000000000000 ],
    [ 0b11_10110101_1101011000001010101011, 0b10111110101011011011010011010010, 0b01001001000101100001_000000000000 ],
    [ 0b11_10110110_1101010000100100101100, 0b11011011011011010100011001010010, 0b11110010111100100001_000000000000 ],
    [ 0b11_10110111_1101010111000001101011, 0b01001100011011010100011000010001, 0b11010111011011110001_000000000000 ],
    [ 0b11_10111000_1101111101010110110001, 0b10111110101011100111111011010011, 0b00101001001110010001_000000000000 ],
    [ 0b11_10111001_1101111010110011110110, 0b00101001101011100111111010010000, 0b00001100101001000001_000000000000 ],
    [ 0b11_10111010_1101110010011101110001, 0b01001100011011101000110000010000, 0b10110111010000000001_000000000000 ],
    [ 0b11_10111011_1101110101111000110110, 0b11011011011011101000110001010011, 0b10010010110111010001_000000000000 ],
    [ 0b11_10111100_1101100011000001101111, 0b11100010001011100111111100010001, 0b11011110010000000001_000000000000 ],
    [ 0b11_10111101_1101100100100100101000, 0b01110101001011100111111101010010, 0b11111011110111010001_000000000000 ],
    [ 0b11_10111110_1101101100001010101111, 0b00010000111011101000110111010010, 0b01000000001110010001_000000000000 ],
    [ 0b11_10111111_1101101011101111101000, 0b10000111111011101000110110010001, 0b01100101101001000001_000000000000 ],
    [ 0b11_11000000_1000101111101111111101, 0b01011010111000101000001011010001, 0b01101011111110010001_000000000000 ],
    [ 0b11_11000001_1000101000001010111010, 0b11001101111000101000001010010010, 0b01001110011001000001_000000000000 ],
    [ 0b11_11000010_1000100000100100111101, 0b10101000001000100111000000010010, 0b11110101100000000001_000000000000 ],
    [ 0b11_11000011_1000100111000001111010, 0b00111111001000100111000001010001, 0b11010000000111010001_000000000000 ],
    [ 0b11_11000100_1000110001111000100011, 0b00000110011000101000001100010011, 0b10011100100000000001_000000000000 ],
    [ 0b11_11000101_1000110110011101100100, 0b10010001011000101000001101010000, 0b10111001000111010001_000000000000 ],
    [ 0b11_11000110_1000111110110011100011, 0b11110100101000100111000111010000, 0b00000010111110010001_000000000000 ],
    [ 0b11_11000111_1000111001010110100100, 0b01100011101000100111000110010011, 0b00100111011001000001_000000000000 ],
    [ 0b11_11001000_1000010011000001111110, 0b10010001011000010100100101010001, 0b11011001001100100001_000000000000 ],
    [ 0b11_11001001_1000010100100100111001, 0b00000110011000010100100100010010, 0b11111100101011110001_000000000000 ],
    [ 0b11_11001010_1000011100001010111110, 0b01100011101000011011101110010010, 0b01000111010010110001_000000000000 ],
    [ 0b11_11001011_1000011011101111111001, 0b11110100101000011011101111010001, 0b01100010110101100001_000000000000 ],
    [ 0b11_11001100_1000001101010110100000, 0b11001101111000010100100010010011, 0b00101110010010110001_000000000000 ],
    [ 0b11_11001101_1000001010110011100111, 0b01011010111000010100100011010000, 0b00001011110101100001_000000000000 ],
    [ 0b11_11001110_1000000010011101100000, 0b00111111001000011011101001010000, 0b10110000001100100001_000000000000 ],
    [ 0b11_11001111_1000000101111000100111, 0b10101000001000011011101000010011, 0b10010101101011110001_000000000000 ],
    [ 0b11_11010000_1001010110110011111101, 0b01011010101000101000010101010000, 0b00001100101100100001_000000000000 ],
    [ 0b11_11010001_1001010001010110111010, 0b11001101101000101000010100010011, 0b00101001001011110001_000000000000 ],
    [ 0b11_11010010_1001011001111000111101, 0b10101000011000100111011110010011, 0b10010010110010110001_000000000000 ],
    [ 0b11_11010011_1001011110011101111010, 0b00111111011000100111011111010000, 0b10110111010101100001_000000000000 ],
    [ 0b11_11010100_1001001000100100100011, 0b00000110001000101000010010010010, 0b11111011110010110001_000000000000 ],
    [ 0b11_11010101_1001001111000001100100, 0b10010001001000101000010011010001, 0b11011110010101100001_000000000000 ],
    [ 0b11_11010110_1001000111101111100011, 0b11110100111000100111011001010001, 0b01100101101100100001_000000000000 ],
    [ 0b11_11010111_1001000000001010100100, 0b01100011111000100111011000010010, 0b01000000001011110001_000000000000 ],
    [ 0b11_11011000_1001101010011101111110, 0b10010001001000010100111011010000, 0b10111110011110010001_000000000000 ],
    [ 0b11_11011001_1001101101111000111001, 0b00000110001000010100111010010011, 0b10011011111001000001_000000000000 ],
    [ 0b11_11011010_1001100101010110111110, 0b01100011111000011011110000010011, 0b00100000000000000001_000000000000 ],
    [ 0b11_11011011_1001100010110011111001, 0b11110100111000011011110001010000, 0b00000101100111010001_000000000000 ],
    [ 0b11_11011100_1001110100001010100000, 0b11001101101000010100111100010010, 0b01001001000000000001_000000000000 ],
    [ 0b11_11011101_1001110011101111100111, 0b01011010101000010100111101010001, 0b01101100100111010001_000000000000 ],
    [ 0b11_11011110_1001111011000001100000, 0b00111111011000011011110111010001, 0b11010111011110010001_000000000000 ],
    [ 0b11_11011111_1001111100100100100111, 0b10101000011000011011110110010010, 0b11110010111001000001_000000000000 ],
    [ 0b11_11100000_1011011101010110110010, 0b01110100101011011010110010010011, 0b00100010110111010001_000000000000 ],
    [ 0b11_11100001_1011011010110011110101, 0b11100011101011011010110011010000, 0b00000111010000000001_000000000000 ],
    [ 0b11_11100010_1011010010011101110010, 0b10000110011011010101111001010000, 0b10111100101001000001_000000000000 ],
    [ 0b11_11100011_1011010101111000110101, 0b00010001011011010101111000010011, 0b10011001001110010001_000000000000 ],
    [ 0b11_11100100_1011000011000001101100, 0b00101000001011011010110101010001, 0b11010101101001000001_000000000000 ],
    [ 0b11_11100101_1011000100100100101011, 0b10111111001011011010110100010010, 0b11110000001110010001_000000000000 ],
    [ 0b11_11100110_1011001100001010101100, 0b11011010111011010101111110010010, 0b01001011110111010001_000000000000 ],
    [ 0b11_11100111_1011001011101111101011, 0b01001101111011010101111111010001, 0b01101110010000000001_000000000000 ],
    [ 0b11_11101000_1011100001111000110001, 0b10111111001011100110011100010011, 0b10010000000101100001_000000000000 ],
    [ 0b11_11101001_1011100110011101110110, 0b00101000001011100110011101010000, 0b10110101100010110001_000000000000 ],
    [ 0b11_11101010_1011101110110011110001, 0b01001101111011101001010111010000, 0b00001110011011110001_000000000000 ],
    [ 0b11_11101011_1011101001010110110110, 0b11011010111011101001010110010011, 0b00101011111100100001_000000000000 ],
    [ 0b11_11101100_1011111111101111101111, 0b11100011101011100110011011010001, 0b01100111011011110001_000000000000 ],
    [ 0b11_11101101_1011111000001010101000, 0b01110100101011100110011010010010, 0b01000010111100100001_000000000000 ],
    [ 0b11_11101110_1011110000100100101111, 0b00010001011011101001010000010010, 0b11111001000101100001_000000000000 ],
    [ 0b11_11101111_1011110111000001101000, 0b10000110011011101001010001010001, 0b11011100100010110001_000000000000 ],
    [ 0b11_11110000_1010100100001010110010, 0b01110100111011011010101100010010, 0b01000101100101100001_000000000000 ],
    [ 0b11_11110001_1010100011101111110101, 0b11100011111011011010101101010001, 0b01100000000010110001_000000000000 ],
    [ 0b11_11110010_1010101011000001110010, 0b10000110001011010101100111010001, 0b11011011111011110001_000000000000 ],
    [ 0b11_11110011_1010101100100100110101, 0b00010001001011010101100110010010, 0b11111110011100100001_000000000000 ],
    [ 0b11_11110100_1010111010011101101100, 0b00101000011011011010101011010000, 0b10110010111011110001_000000000000 ],
    [ 0b11_11110101_1010111101111000101011, 0b10111111011011011010101010010011, 0b10010111011100100001_000000000000 ],
    [ 0b11_11110110_1010110101010110101100, 0b11011010101011010101100000010011, 0b00101100100101100001_000000000000 ],
    [ 0b11_11110111_1010110010110011101011, 0b01001101101011010101100001010000, 0b00001001000010110001_000000000000 ],
    [ 0b11_11111000_1010011000100100110001, 0b10111111011011100110000010010010, 0b11110111010111010001_000000000000 ],
    [ 0b11_11111001_1010011111000001110110, 0b00101000011011100110000011010001, 0b11010010110000000001_000000000000 ],
    [ 0b11_11111010_1010010111101111110001, 0b01001101101011101001001001010001, 0b01101001001001000001_000000000000 ],
    [ 0b11_11111011_1010010000001010110110, 0b11011010101011101001001000010010, 0b01001100101110010001_000000000000 ],
];
